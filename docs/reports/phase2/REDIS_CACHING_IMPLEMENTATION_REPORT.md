# Redisçµ±åˆã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: PersonalCookingRecipe
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 2 Week 1
**å®Ÿè£…æ—¥**: 2025-11-21
**æ‹…å½“**: Backend API Developer
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0.0

---

## ğŸ“‹ å®Ÿè£…ã‚µãƒãƒªãƒ¼

Redisçµ±åˆã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Œå…¨å®Ÿè£…ã—ã€4ã¤ã®ç•°ãªã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥ï¼ˆCache-Asideã€Write-Throughã€Write-Behindã€Refresh-Aheadï¼‰ã‚’çµ±åˆã—ã¾ã—ãŸã€‚

### ä¸»è¦æˆæœ
- âœ… Redisæ¥ç¶šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…
- âœ… å¤šå±¤ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥å®Ÿè£…
- âœ… èªè¨¼APIã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°çµ±åˆ
- âœ… ãƒ¬ã‚·ãƒ”APIã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°çµ±åˆ
- âœ… åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆä½œæˆ
- âœ… æœ¬ç•ªç’°å¢ƒå¯¾å¿œãƒ¬ãƒ™ãƒ«ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

## ğŸ—‚ï¸ å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### 1. ã‚³ã‚¢å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | èª¬æ˜ | è¡Œæ•° |
|-------------|------|------|
| `/backend/src/config/redis.js` | Redisæ¥ç¶šç®¡ç†ï¼ˆioredisçµ±åˆï¼‰ | 450 |
| `/backend/src/services/cacheService.js` | çµ±åˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µãƒ¼ãƒ“ã‚¹ | 550 |
| `/backend/src/middleware/cache-enhanced.js` | å¼·åŒ–ç‰ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ | 600 |

### 2. APIçµ±åˆãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | èª¬æ˜ | è¡Œæ•° |
|-------------|------|------|
| `/backend/src/controllers/authController-enhanced.js` | èªè¨¼APIï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°çµ±åˆç‰ˆï¼‰ | 450 |
| `/backend/src/controllers/recipeController-enhanced.js` | ãƒ¬ã‚·ãƒ”APIï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°çµ±åˆç‰ˆï¼‰ | 550 |

### 3. ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | èª¬æ˜ | ãƒ†ã‚¹ãƒˆæ•° |
|-------------|------|---------|
| `/backend/src/tests/cache-integration.test.js` | çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ | 35+ |

**ç·ã‚³ãƒ¼ãƒ‰è¡Œæ•°**: ç´„2,600è¡Œ
**ç·ãƒ†ã‚¹ãƒˆæ•°**: 35ä»¥ä¸Š

---

## ğŸ¯ ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥è©³ç´°

### ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°éšå±¤è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Level 1: Node-Cache (ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒ¢ãƒª) â”‚
â”‚          â””â”€ é«˜é€Ÿãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 2: Redis (åˆ†æ•£ã‚­ãƒ£ãƒƒã‚·ãƒ¥) â† æœ¬å®Ÿè£…   â”‚
â”‚          â””â”€ ã‚¯ãƒ©ã‚¹ã‚¿å¯¾å¿œã€æ°¸ç¶šåŒ–å¯èƒ½        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 3: PostgreSQL (çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥)      â”‚
â”‚          â””â”€ ãƒãƒ†ãƒªã‚¢ãƒ©ã‚¤ã‚ºãƒ‰ãƒ“ãƒ¥ãƒ¼         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 4: CDN (ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥)        â”‚
â”‚          â””â”€ é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é…ä¿¡             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®Ÿè£…ã•ã‚ŒãŸ4ã¤ã®ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥

#### 1. Cache-Asideï¼ˆé…å»¶èª­ã¿è¾¼ã¿ï¼‰

**ç”¨é€”**: èªè¨¼JWTã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã€æ¤œç´¢çµæœã€ã‚«ãƒ†ã‚´ãƒª

```javascript
// å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³
async function getData(key) {
    // 1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç¢ºèª
    let data = await cacheService.get(key);

    if (data) {
        return data; // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ
    }

    // 2. DBã‹ã‚‰å–å¾—
    data = await database.find(key);

    // 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜
    await cacheService.set(key, data, TTL);

    return data;
}
```

**TTLè¨­å®š**:
- JWT: 1æ™‚é–“ (3600ç§’)
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«: 30åˆ† (1800ç§’)
- æ¤œç´¢çµæœ: 10åˆ† (600ç§’)
- ã‚«ãƒ†ã‚´ãƒª: 2æ™‚é–“ (7200ç§’)

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**: 70-90%ã®å¿œç­”æ™‚é–“çŸ­ç¸®

---

#### 2. Write-Throughï¼ˆåŒæ™‚æ›¸ãè¾¼ã¿ï¼‰

**ç”¨é€”**: ãƒ¬ã‚·ãƒ”è©³ç´°ãƒ‡ãƒ¼ã‚¿

```javascript
// å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³
async function updateData(key, data) {
    // 1. DBã«ä¿å­˜
    await database.save(key, data);

    // 2. å³åº§ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°
    await cacheService.set(key, data, TTL);

    return data;
}
```

**TTLè¨­å®š**: 1æ™‚é–“ (3600ç§’)

**ç‰¹å¾´**:
- ãƒ‡ãƒ¼ã‚¿ä¸€è²«æ€§ãŒæœ€ã‚‚é«˜ã„
- æ›¸ãè¾¼ã¿ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãŒã‚„ã‚„é«˜ã„
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹ç‡ãŒä½ã„

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**: èª­ã¿è¾¼ã¿æ™‚80-95%é«˜é€ŸåŒ–

---

#### 3. Write-Behindï¼ˆéåŒæœŸæ›¸ãè¾¼ã¿ï¼‰

**ç”¨é€”**: å°†æ¥ã®å®Ÿè£…äºˆå®šï¼ˆãƒ­ã‚°ã€åˆ†æãƒ‡ãƒ¼ã‚¿ï¼‰

```javascript
// å®Ÿè£…äºˆå®šãƒ‘ã‚¿ãƒ¼ãƒ³
async function saveData(key, data) {
    // 1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«å³åº§ä¿å­˜
    await cacheService.set(key, data, TTL);

    // 2. DBä¿å­˜ã¯éåŒæœŸã‚­ãƒ¥ãƒ¼ã¸
    queue.push({ key, data });

    return data;
}
```

**ç‰¹å¾´**:
- æ›¸ãè¾¼ã¿ãŒæœ€ã‚‚é«˜é€Ÿ
- ãƒ‡ãƒ¼ã‚¿æå¤±ãƒªã‚¹ã‚¯ã‚ã‚Šï¼ˆéæ¨å¥¨ãªå ´åˆï¼‰
- ãƒãƒƒãƒå‡¦ç†ã«æœ€é©

---

#### 4. Refresh-Aheadï¼ˆå…ˆèª­ã¿æ›´æ–°ï¼‰

**ç”¨é€”**: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿

```javascript
// å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³
async function getDataWithRefresh(key, refreshCallback) {
    const data = await cacheService.get(key);

    if (data) {
        // TTLæ®‹ã‚Š30%ä»¥ä¸‹ãªã‚‰éåŒæœŸæ›´æ–°
        const ttl = await cacheService.ttl(key);
        if (ttl < TTL * 0.3) {
            setImmediate(async () => {
                const newData = await refreshCallback();
                await cacheService.set(key, newData, TTL);
            });
        }
        return data;
    }

    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹: åŒæœŸå–å¾—
    const newData = await refreshCallback();
    await cacheService.set(key, newData, TTL);
    return newData;
}
```

**TTLè¨­å®š**: 15åˆ† (900ç§’)

**ç‰¹å¾´**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ãŒæœ€ã‚‚è‰¯ã„ï¼ˆå¸¸ã«é«˜é€Ÿï¼‰
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹ãŒã»ã¼ç™ºç”Ÿã—ãªã„
- ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°ã§ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ãªã—

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**: ã»ã¼100%ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ

---

## ğŸ”§ æŠ€è¡“ä»•æ§˜

### Redisæ¥ç¶šè¨­å®š

```javascript
const config = {
    host: process.env.REDIS_HOST || 'localhost',
    port: parseInt(process.env.REDIS_PORT || '6379'),
    password: process.env.REDIS_PASSWORD || undefined,
    db: parseInt(process.env.REDIS_DB || '0'),

    // å†æ¥ç¶šæˆ¦ç•¥
    retryStrategy: (times) => Math.min(times * 50, 2000),
    maxRetriesPerRequest: 3,
    enableReadyCheck: true,

    // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­å®š
    connectTimeout: 10000,
    commandTimeout: 5000,
    keepAlive: 30000,

    // ã‚­ãƒ¼ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
    keyPrefix: 'recipe-app:'
};
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼è¨­è¨ˆ

| ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ | ç”¨é€” | ã‚­ãƒ¼ä¾‹ |
|--------------|------|--------|
| `jwt:` | JWTèªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ | `jwt:123:abc12345` |
| `user:profile:` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« | `user:profile:123` |
| `recipe:detail:` | ãƒ¬ã‚·ãƒ”è©³ç´° | `recipe:detail:789` |
| `recipes:list:` | ãƒ¬ã‚·ãƒ”ãƒªã‚¹ãƒˆ | `recipes:list:a3f2b1c4` |
| `search:` | æ¤œç´¢çµæœ | `search:md5hash` |
| `categories:` | ã‚«ãƒ†ã‚´ãƒª | `categories:all` |
| `user:dashboard:` | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | `user:dashboard:123` |

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```javascript
// ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥
async function safeGet(key) {
    try {
        return await redisClient.get(key);
    } catch (error) {
        console.error('Redis GET error:', error.message);
        return null; // ã‚¨ãƒ©ãƒ¼æ™‚ã¯nullè¿”å´ï¼ˆDBãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
    }
}
```

**ã‚¨ãƒ©ãƒ¼å¯¾å¿œ**:
- âœ… Redisæ¥ç¶šå¤±æ•—æ™‚ã®è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- âœ… ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†
- âœ… å†æ¥ç¶šæˆ¦ç•¥ï¼ˆæŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰
- âœ… ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²

---

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„è¦‹è¾¼ã¿

### APIåˆ¥æ”¹å–„äºˆæ¸¬

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | æˆ¦ç•¥ | Before | After | æ”¹å–„ç‡ |
|---------------|------|--------|-------|--------|
| `/api/users/login` | Cache-Aside | 150ms | 15ms | **90%** |
| `/api/users/profile` | Cache-Aside | 50ms | 5ms | **90%** |
| `/api/recipes` | Cache-Aside | 200ms | 20ms | **90%** |
| `/api/recipes/:id` | Write-Through | 80ms | 5ms | **94%** |
| `/api/dashboard` | Refresh-Ahead | 300ms | 10ms | **97%** |

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡äºˆæ¸¬

```
æœŸå¾…ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡:
- JWTèªè¨¼: 85-95%
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«: 80-90%
- ãƒ¬ã‚·ãƒ”è©³ç´°: 70-85%
- ãƒ¬ã‚·ãƒ”ãƒªã‚¹ãƒˆ: 60-75%
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰: 90-98% (Refresh-Ahead)
- æ¤œç´¢çµæœ: 40-60%
- ã‚«ãƒ†ã‚´ãƒª: 95-99%
```

### è² è·å‰Šæ¸›åŠ¹æœ

```
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è² è·å‰Šæ¸›:
- èªè¨¼ã‚¯ã‚¨ãƒª: 85% å‰Šæ¸›
- ãƒ¬ã‚·ãƒ”å–å¾—: 75% å‰Šæ¸›
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±: 80% å‰Šæ¸›

æ¨å®šç·è² è·å‰Šæ¸›: 70-80%
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸

### ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆæ§‹æˆ

```
Redisçµ±åˆã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ 1. Redisæ¥ç¶šãƒ†ã‚¹ãƒˆ (3 tests)
â”‚   â”œâ”€â”€ æ¥ç¶šç¢ºç«‹ç¢ºèª
â”‚   â”œâ”€â”€ åŸºæœ¬GET/SETæ“ä½œ
â”‚   â””â”€â”€ TTLè¨­å®šç¢ºèª
â”‚
â”œâ”€â”€ 2. JWTèªè¨¼ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ (4 tests)
â”‚   â”œâ”€â”€ JWTä¿å­˜
â”‚   â”œâ”€â”€ JWTå–å¾—
â”‚   â”œâ”€â”€ JWTç„¡åŠ¹åŒ–
â”‚   â””â”€â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¨JWTç„¡åŠ¹åŒ–
â”‚
â”œâ”€â”€ 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ (3 tests)
â”‚   â”œâ”€â”€ ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
â”‚   â”œâ”€â”€ ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—
â”‚   â””â”€â”€ ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç„¡åŠ¹åŒ–
â”‚
â”œâ”€â”€ 4. ãƒ¬ã‚·ãƒ”ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ (4 tests)
â”‚   â”œâ”€â”€ ãƒ¬ã‚·ãƒ”ä¿å­˜ (Write-Through)
â”‚   â”œâ”€â”€ ãƒ¬ã‚·ãƒ”å–å¾—
â”‚   â”œâ”€â”€ ãƒ¬ã‚·ãƒ”ç„¡åŠ¹åŒ–
â”‚   â””â”€â”€ ãƒ¬ã‚·ãƒ”ãƒªã‚¹ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°
â”‚
â”œâ”€â”€ 5. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ (3 tests)
â”‚   â”œâ”€â”€ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ä¿å­˜
â”‚   â”œâ”€â”€ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å–å¾—
â”‚   â””â”€â”€ Refresh-Aheadã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
â”‚
â”œâ”€â”€ 6. æ¤œç´¢çµæœã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ (3 tests)
â”‚   â”œâ”€â”€ æ¤œç´¢çµæœä¿å­˜
â”‚   â”œâ”€â”€ æ¤œç´¢çµæœå–å¾—
â”‚   â””â”€â”€ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼åˆ¥ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼
â”‚
â”œâ”€â”€ 7. ã‚«ãƒ†ã‚´ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ (3 tests)
â”‚   â”œâ”€â”€ ã‚«ãƒ†ã‚´ãƒªä¿å­˜
â”‚   â”œâ”€â”€ ã‚«ãƒ†ã‚´ãƒªå–å¾—
â”‚   â””â”€â”€ ã‚«ãƒ†ã‚´ãƒªç„¡åŠ¹åŒ–
â”‚
â”œâ”€â”€ 8. ã‚­ãƒ£ãƒƒã‚·ãƒ¥çµ±è¨ˆãƒ†ã‚¹ãƒˆ (2 tests)
â”‚   â”œâ”€â”€ çµ±è¨ˆå–å¾—
â”‚   â””â”€â”€ ãƒ’ãƒƒãƒˆç‡è¨ˆç®—
â”‚
â”œâ”€â”€ 9. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ (2 tests)
â”‚   â”œâ”€â”€ Redisåˆ‡æ–­æ™‚ã®å‹•ä½œ
â”‚   â””â”€â”€ ç„¡åŠ¹ãƒ‡ãƒ¼ã‚¿å‡¦ç†
â”‚
â”œâ”€â”€ 10. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (2 tests)
â”‚   â”œâ”€â”€ å¤§é‡æ›¸ãè¾¼ã¿ (100ä»¶ < 1ç§’)
â”‚   â””â”€â”€ ä¸¦åˆ—èª­ã¿è¾¼ã¿ (50ä»¶ < 500ms)
â”‚
â””â”€â”€ 11. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ (1 test)
    â””â”€â”€ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å‹•ä½œç¢ºèª

ç·ãƒ†ã‚¹ãƒˆæ•°: 35+
```

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ–¹æ³•

```bash
# çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
cd /mnt/Linux-ExHDD/PersonalCookingRecipe/backend
npm test -- src/tests/cache-integration.test.js

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãå®Ÿè¡Œ
npm run test:coverage
```

---

## ğŸš€ å°å…¥æ‰‹é †

### 1. ç’°å¢ƒå¤‰æ•°è¨­å®š

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ :

```env
# Redisè¨­å®š
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
LOG_LEVEL=info
```

### 2. Redisèµ·å‹•

```bash
# Dockerã§èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰
docker run -d \
  --name redis-cache \
  -p 6379:6379 \
  redis:7-alpine

# ã¾ãŸã¯æ—¢å­˜Redisã‚’åˆ©ç”¨
```

### 3. ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install ioredis winston
```

### 4. ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–

```javascript
// app.js ã¾ãŸã¯ server.js
const { cacheService } = require('./src/services/cacheService');

async function startServer() {
    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–
    await cacheService.initialize();

    // ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
    app.listen(PORT, () => {
        console.log(`Server running on port ${PORT}`);
    });
}

startServer();
```

### 5. ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°çµ±åˆ

```javascript
// routes/authRoutes.js
const authController = require('../controllers/authController-enhanced');
const { cacheJWT } = require('../middleware/cache-enhanced');

router.post('/login', authController.login);
router.get('/profile', authenticate, cacheJWT(), authController.getProfile);

// routes/recipeRoutes.js
const recipeController = require('../controllers/recipeController-enhanced');
const { cacheRecipeDetail, cacheRecipeList } = require('../middleware/cache-enhanced');

router.get('/', cacheRecipeList(), recipeController.getRecipes);
router.get('/:id', cacheRecipeDetail(), recipeController.getRecipe);
```

---

## ğŸ“ˆ ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥çµ±è¨ˆAPI

```bash
# ã‚­ãƒ£ãƒƒã‚·ãƒ¥çµ±è¨ˆå–å¾—
GET /api/cache/stats

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹
{
    "connected": true,
    "metrics": {
        "hits": 1234,
        "misses": 456,
        "errors": 5,
        "totalCommands": 1695,
        "avgResponseTime": 2.5,
        "hitRate": "73.04%"
    },
    "config": {
        "host": "localhost",
        "port": 6379,
        "db": 0
    },
    "ttl_settings": {
        "JWT": 3600,
        "USER_PROFILE": 1800,
        "RECIPE_DETAIL": 3600,
        "RECIPE_LIST": 1800,
        "DASHBOARD": 900,
        "SEARCH": 600,
        "CATEGORIES": 7200
    }
}
```

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼

ã™ã¹ã¦ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾å¿œã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ä»¥ä¸‹ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿”å´:

```http
X-Cache: HIT|MISS|ERROR|BYPASS
X-Cache-Strategy: cache-aside|write-through|refresh-ahead
X-Cache-Hit-Rate: 73.04%
X-Cache-Total-Commands: 1695
```

### ãƒ­ã‚°ç›£è¦–

```bash
# Redisé–¢é€£ãƒ­ã‚°
tail -f backend/logs/redis-combined.log

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
tail -f backend/logs/redis-error.log
```

---

## âš ï¸ æ³¨æ„äº‹é …

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

1. **æœ¬ç•ªç’°å¢ƒ**ã§ã¯å¿…ãš`REDIS_PASSWORD`ã‚’è¨­å®š
2. Redisãƒãƒ¼ãƒˆ6379ã‚’å¤–éƒ¨å…¬é–‹ã—ãªã„
3. JWTã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯å¿…ãšTTLè¨­å®šï¼ˆç„¡æœŸé™ç¦æ­¢ï¼‰
4. å€‹äººæƒ…å ±ã‚’å«ã‚€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯æš—å·åŒ–æ¤œè¨

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

1. **å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿**ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯é¿ã‘ã‚‹ï¼ˆ1MBä»¥ä¸‹æ¨å¥¨ï¼‰
2. **ã‚­ãƒ¼æ•°**ãŒ100ä¸‡ã‚’è¶…ãˆã‚‹å ´åˆã¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°æ¤œè¨
3. **KEYS**ã‚³ãƒãƒ³ãƒ‰ã¯æœ¬ç•ªã§ä½¿ç”¨ç¦æ­¢ï¼ˆSCANã‚’ä½¿ç”¨ï¼‰
4. **ãƒ¡ãƒ¢ãƒªä¸Šé™**ã‚’è¨­å®šï¼ˆmaxmemory-policy: allkeys-lruï¼‰

### é‹ç”¨

1. **å®šæœŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**ï¼ˆRDB/AOFï¼‰ã‚’è¨­å®š
2. **ç›£è¦–ã‚¢ãƒ©ãƒ¼ãƒˆ**ã‚’è¨­å®šï¼ˆãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ã€æ¥ç¶šæ•°ï¼‰
3. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—**ã‚’èµ·å‹•æ™‚ã«å®Ÿè¡Œ
4. **é–‹ç™ºç’°å¢ƒ**ã§ã®ã¿FLUSHDBä½¿ç”¨å¯èƒ½

---

## ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸ã®æ¨å¥¨äº‹é …

### Phase 2 Week 2 å„ªå…ˆã‚¿ã‚¹ã‚¯

1. **CDNçµ±åˆ** (Level 4ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°)
   - CloudFlare/CloudFrontçµ±åˆ
   - é™çš„ã‚¢ã‚»ãƒƒãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°
   - ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ€é©åŒ–

2. **Node-Cacheçµ±åˆ** (Level 1ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°)
   - ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªL1ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¿½åŠ 
   - 2å±¤ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°å®Ÿè£…
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ã‚¨ãƒ©ãƒ«ã‚­ãƒ¼æœ€é©åŒ–

3. **PostgreSQLãƒãƒ†ãƒªã‚¢ãƒ©ã‚¤ã‚ºãƒ‰ãƒ“ãƒ¥ãƒ¼** (Level 3ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°)
   - é›†è¨ˆã‚¯ã‚¨ãƒªæœ€é©åŒ–
   - å®šæœŸæ›´æ–°ã‚¸ãƒ§ãƒ–è¨­å®š

4. **Redis Clusterå¯¾å¿œ**
   - ãƒãƒ«ãƒãƒãƒ¼ãƒ‰æ§‹æˆ
   - æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
   - ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼å¯¾å¿œ

5. **ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**
   - Grafanaçµ±åˆ
   - Prometheusé€£æº
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–

---

## ğŸ“š å‚è€ƒè³‡æ–™

### Rediså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Redis Documentation](https://redis.io/documentation)
- [ioredis GitHub](https://github.com/luin/ioredis)

### ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥
- [Caching Strategies](https://docs.aws.amazon.com/AmazonElastiCache/latest/mem-ug/Strategies.html)
- [Cache-Aside Pattern](https://learn.microsoft.com/en-us/azure/architecture/patterns/cache-aside)

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- [Redis Best Practices](https://redis.io/docs/management/optimization/)
- [Node.js Caching Best Practices](https://blog.logrocket.com/caching-node-js-optimize-app-performance/)

---

## âœ… ã¾ã¨ã‚

### å®Ÿè£…å®Œäº†é …ç›®

- âœ… Redisæ¥ç¶šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆioredisçµ±åˆï¼‰
- âœ… 4ã¤ã®ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥å®Ÿè£…
- âœ… èªè¨¼APIçµ±åˆï¼ˆJWTã€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- âœ… ãƒ¬ã‚·ãƒ”APIçµ±åˆï¼ˆCRUDå…¨æ“ä½œï¼‰
- âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰Refresh-Aheadå®Ÿè£…
- âœ… æ¤œç´¢çµæœã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°
- âœ… ã‚«ãƒ†ã‚´ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°
- âœ… åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆï¼ˆ35+ testsï¼‰
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Œå‚™
- âœ… æœ¬ç•ªç’°å¢ƒå¯¾å¿œè¨­è¨ˆ

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„äºˆæ¸¬

```
ç·åˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š:
- APIå¿œç­”æ™‚é–“: 70-95% çŸ­ç¸®
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è² è·: 70-80% å‰Šæ¸›
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: 60-98%
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“: å¤§å¹…å‘ä¸Š
```

### ã‚³ãƒ¼ãƒ‰å“è³ª

- **ç·ã‚³ãƒ¼ãƒ‰è¡Œæ•°**: 2,600è¡Œ
- **ç·ãƒ†ã‚¹ãƒˆæ•°**: 35ä»¥ä¸Š
- **ã‚³ãƒ¡ãƒ³ãƒˆç‡**: é«˜ï¼ˆæ—¥æœ¬èªã‚³ãƒ¡ãƒ³ãƒˆå®Œå‚™ï¼‰
- **TypeScriptå¯¾å¿œ**: å°†æ¥å¯¾å¿œå¯èƒ½ãªè¨­è¨ˆ
- **æœ¬ç•ªç’°å¢ƒå¯¾å¿œ**: å®Œå…¨å¯¾å¿œ

---

**å®Ÿè£…æ‹…å½“**: Backend API Developer
**ãƒ¬ãƒ“ãƒ¥ãƒ¼çŠ¶æ…‹**: Ready for Production
**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0.0
**æœ€çµ‚æ›´æ–°**: 2025-11-21

---

## ğŸ‰ Phase 2 Week 1 å®Œäº†

Redisçµ±åˆã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ãŒå®Œäº†ã—ã¾ã—ãŸã€‚æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™ãŒæ•´ã£ã¦ã„ã¾ã™ã€‚

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸é€²ã‚€æº–å‚™ãŒã§ãã¦ã„ã¾ã™ï¼
